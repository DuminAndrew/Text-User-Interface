# Log Analyzer - Build and Test Guide

## Быстрый старт

Этот проект содержит автоматические скрипты для сборки, тестирования и демонстрации Log Analyzer.

### Для Windows

Просто запустите **один файл**:
```cmd
build_and_test.bat
```

Этот скрипт автоматически:
1. ✅ Очистит директорию build
2. ✅ Настроит CMake с Ninja
3. ✅ Соберёт проект
4. ✅ Запустит все 33 теста
5. ✅ Создаст демонстрационный лог-файл
6. ✅ Запустит приложение для демонстрации

### Для Linux/Mac

Просто запустите **один файл**:
```bash
./build_and_test.sh
```

Этот скрипт делает то же самое, что и Windows версия.

---

## Что делают скрипты

### build_and_test.bat / build_and_test.sh
Главный скрипт, который делает всё автоматически:
- Проверяет наличие Ninja и CMake
- Очищает и создаёт build директорию
- Настраивает проект с CMake
- Компилирует с использованием Ninja
- Запускает все unit-тесты (33 теста)
- Создаёт демо лог-файл (если его нет)
- Запускает приложение с демо-логом

### create_demo_log.bat / create_demo_log.sh
Вспомогательный скрипт для создания демонстрационного лог-файла (demo.log) с 47 строками:
- INFO сообщения
- DEBUG сообщения
- WARNING сообщения
- ERROR сообщения
- CRITICAL сообщения
- SQL запросы
- JSON данные

---

## Требования

### Windows
- CMake 3.14+
- Ninja Build System
- C++ компилятор (MSVC, MinGW-GCC, или Clang)

Установка Ninja:
```cmd
# Скачайте с https://github.com/ninja-build/ninja/releases
# Или через chocolatey:
choco install ninja
```

### Linux
```bash
sudo apt-get install cmake ninja-build g++
```

### macOS
```bash
brew install cmake ninja
```

---

## Структура тестов

Проект включает **33 unit-теста**, разделённых на 3 группы:

### 1. LogReader Tests (8 тестов)
- ✅ Открытие валидных/невалидных файлов
- ✅ Подсчёт строк
- ✅ Чтение отдельных строк
- ✅ Чтение диапазонов строк
- ✅ Получение размера файла
- ✅ Закрытие файлов
- ✅ Обработка пустых файлов

### 2. FilterEngine Tests (12 тестов)
- ✅ Установка валидных/невалидных regex паттернов
- ✅ Фильтрация по простым паттернам
- ✅ Фильтрация по regex
- ✅ Case-insensitive поиск
- ✅ Асинхронная фильтрация
- ✅ Сложные regex паттерны

### 3. SyntaxHighlighter Tests (13 тестов)
- ✅ Подсветка SQL ключевых слов
- ✅ Подсветка JSON
- ✅ Подсветка чисел
- ✅ Подсветка строк
- ✅ Обработка Unicode символов
- ✅ Обработка длинных строк

---

## Использование приложения

После успешной сборки:

### Запуск с демо-логом
```bash
./build/log_analyzer demo.log
```

### Запуск с вашим лог-файлом
```bash
./build/log_analyzer /path/to/your/logfile.log
```

### Управление в приложении
- **↑/↓** - Навигация по строкам
- **PgUp/PgDn** - Прокрутка страницами
- **Home/End** - Переход к началу/концу
- **H** - Включить/выключить подсветку синтаксиса
- **Q/Esc** - Выход

---

## Только сборка (без тестов)

Если нужно только собрать проект:

### Windows
```cmd
mkdir build
cd build
cmake -G Ninja -DCMAKE_BUILD_TYPE=Release ..
ninja
```

### Linux/Mac
```bash
mkdir build
cd build
cmake -G Ninja -DCMAKE_BUILD_TYPE=Release ..
ninja
```

---

## Только тесты (после сборки)

```bash
cd build
ctest --output-on-failure
```

Или запустить напрямую:
```bash
./build/log_analyzer_tests
```

---

## Производительность

- **Сборка**: ~30-60 секунд (в зависимости от системы)
- **Тесты**: ~0.3 секунды (все 33 теста)
- **Общее время**: ~1-2 минуты

---

## Возможные проблемы

### "Ninja not found"
Установите Ninja согласно инструкциям выше.

### "CMake not found"
Установите CMake 3.14 или новее.

### Ошибки компиляции
Убедитесь, что у вас установлен C++20 совместимый компилятор:
- GCC 10+
- Clang 10+
- MSVC 2019+

### Тесты не проходят
Убедитесь, что все зависимости (FTXUI, Google Test) загружены корректно.
Попробуйте очистить build директорию и пересобрать.

---

## Дополнительная информация

- Проект использует **memory-mapped файлы** для быстрого доступа к большим логам
- Поддерживает файлы размером до **50+ GB**
- **Regex фильтрация** в реальном времени
- **Syntax highlighting** для JSON/SQL

Для подробной информации см. [README.md](README.md)
